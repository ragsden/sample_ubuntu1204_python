language: python

build_image: shippableimages/ubuntu1204_python

images:
  image:
    build:
      type: docker
      name: ragster/myrags
      tag: latest
      code_path: /home/avinci/src

commit_container: ragster/demo

python:
  - 2.7
  #- 3.3
  #- 3.4
  
before_install:
  # We're going to set up a virtualenv and activate the python version we want to use
  - mkdir -p $HOME/sample_ve/
  - virtualenv -p /usr/bin/python$PYTHON_VERSION $HOME/sample_ve/
  - source $HOME/sample_ve/bin/activate
  
install:
  - pip install -r requirements.txt

# Make folders for the reports
before_script:
  - cd $SHIPPABLE_REPO_DIR && mkdir -p shippable/testresults
  - cd $SHIPPABLE_REPO_DIR && mkdir -p shippable/codecoverage

script:
  - env
  - ls
  - echo $PWD
  - cd $SHIPPABLE_REPO_DIR && nosetests test.py --with-xunit --xunit-file=shippable/testresults/nosetests.xml
  - cd $SHIPPABLE_REPO_DIR && which python && coverage run --branch test.py
  - cd $SHIPPABLE_REPO_DIR && which python && coverage xml -o shippable/codecoverage/coverage.xml test.py
